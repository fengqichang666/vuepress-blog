<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS工具函数 | 前端笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="前端笔记">
    
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.a40a9d3e.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.ae308451.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/2.9d54d2e6.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/8.a3e3bbda.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/10.9cfc9567.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.3d077320.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.555fb7d9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.7bfdc094.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.04b16a6e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/15.a4e3bda4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.4d164b2f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.7fa352c1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.0a23db7e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.dda8cf70.js"><link rel="prefetch" href="/vuepress-blog/assets/js/20.54572099.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.37f1d204.js"><link rel="prefetch" href="/vuepress-blog/assets/js/22.dbccb16a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/23.43a77620.js"><link rel="prefetch" href="/vuepress-blog/assets/js/24.fc4eb2fe.js"><link rel="prefetch" href="/vuepress-blog/assets/js/25.91a3e6c3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/26.fcd26691.js"><link rel="prefetch" href="/vuepress-blog/assets/js/27.a339bfc4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/28.5ebd68a8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/29.44f0800f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/3.446fcee1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/30.c1d65828.js"><link rel="prefetch" href="/vuepress-blog/assets/js/31.5e6969f9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/32.e47746a1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/33.a737a274.js"><link rel="prefetch" href="/vuepress-blog/assets/js/34.1bf44f55.js"><link rel="prefetch" href="/vuepress-blog/assets/js/35.ba7921cb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/36.49fdf229.js"><link rel="prefetch" href="/vuepress-blog/assets/js/37.d72b0415.js"><link rel="prefetch" href="/vuepress-blog/assets/js/38.9072547a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/39.27723f7b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/4.c72729ae.js"><link rel="prefetch" href="/vuepress-blog/assets/js/40.2e56f701.js"><link rel="prefetch" href="/vuepress-blog/assets/js/41.ce193a1e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/42.78ead8bc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/43.8212ce5d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/44.0129c968.js"><link rel="prefetch" href="/vuepress-blog/assets/js/45.507f6c29.js"><link rel="prefetch" href="/vuepress-blog/assets/js/46.256af657.js"><link rel="prefetch" href="/vuepress-blog/assets/js/47.b423c42f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/48.3dd4dd00.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.698d18d8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.18c29f84.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.1f43074c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/9.43e7f945.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.a40a9d3e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><!----> <span class="site-name">前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>列表</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog/commonJS与es6模块化.html" class="sidebar-link">exports、module.exports和export、export default</a></li><li><a href="/vuepress-blog/eslint使用、报错部分快速修复.html" class="sidebar-link">vue-cli中eslint检验指定文件/夹、报错部分快速修复</a></li><li><a href="/vuepress-blog/git-HEAD-与HEAD-的区别.html" class="sidebar-link">git HEAD~与HEAD^的区别</a></li><li><a href="/vuepress-blog/git-merge-no-ff-与-ff-和-squash的区别.html" class="sidebar-link">git merge --no-ff 与--ff 和--squash的区别</a></li><li><a href="/vuepress-blog/Git凭据管理的三种方式-https.html" class="sidebar-link">Git凭据管理的三种方式(https)</a></li><li><a href="/vuepress-blog/git操作指令.html" class="sidebar-link">git命令总结</a></li><li><a href="/vuepress-blog/JS工具函数.html" class="active sidebar-link">JS工具函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_1、校验数据类型" class="sidebar-link">1、校验数据类型</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_2、防抖" class="sidebar-link">2、防抖</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_3、节流" class="sidebar-link">3、节流</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_4、手机号脱敏" class="sidebar-link">4、手机号脱敏</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_5、开启全屏" class="sidebar-link">5、开启全屏</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_6、关闭全屏" class="sidebar-link">6、关闭全屏</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_7、大小写转换" class="sidebar-link">7、大小写转换</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_8、解析url参数" class="sidebar-link">8、解析URL参数</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_9、判断手机是andoird还是ios" class="sidebar-link">9、判断手机是Andoird还是IOS</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_10、数组对象根据字段去重" class="sidebar-link">10、数组对象根据字段去重</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_11、滚动到页面顶部" class="sidebar-link">11、滚动到页面顶部</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_12、滚动到元素位置" class="sidebar-link">12、滚动到元素位置</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_13、金额格式化" class="sidebar-link">13、金额格式化</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_14、存储操作" class="sidebar-link">14、存储操作</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_15、下载文件" class="sidebar-link">15、下载文件</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_16、深拷贝" class="sidebar-link">16、深拷贝</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_17、模糊搜索" class="sidebar-link">17、模糊搜索</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_18、遍历树节点" class="sidebar-link">18、遍历树节点</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/JS工具函数.html#_19、停止冒泡事件" class="sidebar-link">19、停止冒泡事件</a></li></ul></li><li><a href="/vuepress-blog/js执行机制.html" class="sidebar-link">js执行机制</a></li><li><a href="/vuepress-blog/nodejs-websocket.html" class="sidebar-link">nodejs-websocket</a></li><li><a href="/vuepress-blog/pinia.html" class="sidebar-link">pinia</a></li><li><a href="/vuepress-blog/Proxy和Object-defineProperty.html" class="sidebar-link">Proxy和Object.defineProperty</a></li><li><a href="/vuepress-blog/react笔记.html" class="sidebar-link">react笔记</a></li><li><a href="/vuepress-blog/router4笔记.html" class="sidebar-link">router4笔记</a></li><li><a href="/vuepress-blog/uniapp笔记.html" class="sidebar-link">uniapp笔记</a></li><li><a href="/vuepress-blog/vite与webpack.html" class="sidebar-link">vite与webpack</a></li><li><a href="/vuepress-blog/vue-elementui-表单检验中发送接口进行校验.html" class="sidebar-link">vue+elementui 表单检验中发送接口进行校验</a></li><li><a href="/vuepress-blog/vue3+elementplus+ts+pinia踩坑记录.html" class="sidebar-link">vue3+elementplus+ts+pinia踩坑记录</a></li><li><a href="/vuepress-blog/vue3笔记.html" class="sidebar-link">vue3笔记</a></li><li><a href="/vuepress-blog/vuex.html" class="sidebar-link">vuex</a></li><li><a href="/vuepress-blog/Vue中extend-mixins-extends以及Vue-use的install和Vue-nextTick.html" class="sidebar-link">Vue中extend,mixins,extends以及Vue.use的install和Vue.nextTick</a></li><li><a href="/vuepress-blog/vue响应式原理及收集依赖.html" class="sidebar-link">vue响应式原理、依赖收集</a></li><li><a href="/vuepress-blog/vue对数组的处理.html" class="sidebar-link">vue对数组的处理</a></li><li><a href="/vuepress-blog/vue知识点记录.html" class="sidebar-link">vue知识点记录</a></li><li><a href="/vuepress-blog/vue第三方组件css修改.html" class="sidebar-link">vue第三方组件css修改</a></li><li><a href="/vuepress-blog/vue组件通信.html" class="sidebar-link">vue组件通信</a></li><li><a href="/vuepress-blog/webpack笔记.html" class="sidebar-link">webpack笔记</a></li><li><a href="/vuepress-blog/前端学习资料.html" class="sidebar-link">前端学习资料</a></li><li><a href="/vuepress-blog/前端性能优化面试题.html" class="sidebar-link">前端性能优化面试题总结</a></li><li><a href="/vuepress-blog/前端鉴权cookie、session、token、jwt、单点登录.html" class="sidebar-link">前端鉴权cookie、session、token、jwt、单点登录</a></li><li><a href="/vuepress-blog/单点登录SSO.html" class="sidebar-link">单点登录SSO</a></li><li><a href="/vuepress-blog/原型链.html" class="sidebar-link">原型链</a></li><li><a href="/vuepress-blog/常用的正则表达式大全.html" class="sidebar-link">常用的正则表达式大全</a></li><li><a href="/vuepress-blog/开发中容易遇到的问题.html" class="sidebar-link">开发中容易遇到的问题</a></li><li><a href="/vuepress-blog/数据类型判断.html" class="sidebar-link">数据类型判断</a></li><li><a href="/vuepress-blog/样式清单整理.html" class="sidebar-link">样式清单整理</a></li><li><a href="/vuepress-blog/组件库开发.html" class="sidebar-link">组件库开发</a></li><li><a href="/vuepress-blog/网站、论坛合集.html" class="sidebar-link">网站、论坛合集</a></li><li><a href="/vuepress-blog/虚拟DOM与DIFF算法.html" class="sidebar-link">虚拟DOM与DIFF算法</a></li><li><a href="/vuepress-blog/详解mixins混入使用.html" class="sidebar-link">详解mixins混入使用</a></li><li><a href="/vuepress-blog/金额输入框封装（千分位，禁止中文输入）.html" class="sidebar-link">金额输入框封装（千分位，禁止中文输入）</a></li><li><a href="/vuepress-blog/键盘事件keydown，keypress，keyup.html" class="sidebar-link">键盘事件keydown，keypress，keyup</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1、校验数据类型"><a href="#_1、校验数据类型" class="header-anchor">#</a> 1、校验数据类型</h2> <div class="language- extra-class"><pre class="language-text"><code>export const typeOf = function(obj) {
  return Object.prototype.toString.call(obj).slice(8, -1).toLowerCase()
}
// 示例
typeOf('树哥')  // string
typeOf([])  // array
typeOf(new Date())  // date
typeOf(null) // null
typeOf(true) // boolean
typeOf(() =&gt; { }) // function
</code></pre></div><h2 id="_2、防抖"><a href="#_2、防抖" class="header-anchor">#</a> 2、防抖</h2> <div class="language- extra-class"><pre class="language-text"><code>export const debounce = (() =&gt; {
  let timer = null
  return (callback, wait = 800) =&gt; {
    timer&amp;&amp;clearTimeout(timer)
    timer = setTimeout(callback, wait)
  }
})()
// 示例
methods: {
  loadList() {
    debounce(() =&gt; {
      console.log('加载数据')
    }, 500)
  }
}
</code></pre></div><h2 id="_3、节流"><a href="#_3、节流" class="header-anchor">#</a> 3、节流</h2> <div class="language- extra-class"><pre class="language-text"><code>export const throttle = (() =&gt; {
  let last = 0
  return (callback, wait = 800) =&gt; {
    let now = +new Date()
    if (now - last &gt; wait) {
      callback()
      last = now
    }
  }
})()
</code></pre></div><h2 id="_4、手机号脱敏"><a href="#_4、手机号脱敏" class="header-anchor">#</a> 4、手机号脱敏</h2> <div class="language- extra-class"><pre class="language-text"><code>export const hideMobile = (mobile) =&gt; {
  return mobile.replace(/^(\d{3})\d{4}(\d{4})$/, &quot;$1****$2&quot;)
}
</code></pre></div><h2 id="_5、开启全屏"><a href="#_5、开启全屏" class="header-anchor">#</a> 5、开启全屏</h2> <div class="language- extra-class"><pre class="language-text"><code>export const launchFullscreen = (element) =&gt; {
  if (element.requestFullscreen) {
    element.requestFullscreen()
  } else if (element.mozRequestFullScreen) {
    element.mozRequestFullScreen()
  } else if (element.msRequestFullscreen) {
    element.msRequestFullscreen()
  } else if (element.webkitRequestFullscreen) {
    element.webkitRequestFullScreen()
  }
}
</code></pre></div><h2 id="_6、关闭全屏"><a href="#_6、关闭全屏" class="header-anchor">#</a> 6、关闭全屏</h2> <div class="language- extra-class"><pre class="language-text"><code>export const exitFullscreen = () =&gt; {
  if (document.exitFullscreen) {
    document.exitFullscreen()
  } else if (document.msExitFullscreen) {
    document.msExitFullscreen()
  } else if (document.mozCancelFullScreen) {
    document.mozCancelFullScreen()
  } else if (document.webkitExitFullscreen) {
    document.webkitExitFullscreen()
  }
}
</code></pre></div><h2 id="_7、大小写转换"><a href="#_7、大小写转换" class="header-anchor">#</a> 7、大小写转换</h2> <div class="language- extra-class"><pre class="language-text"><code>// str 待转换的字符串
// type 1-全大写 2-全小写 3-首字母大写
export const turnCase = (str, type) =&gt; {
  switch (type) {
    case 1:
      return str.toUpperCase()
    case 2:
      return str.toLowerCase()
    case 3:
      //return str[0].toUpperCase() + str.substr(1).toLowerCase() // substr 已不推荐使用
      return str[0].toUpperCase() + str.substring(1).toLowerCase()
    default:
      return str
  }
}
</code></pre></div><h2 id="_8、解析url参数"><a href="#_8、解析url参数" class="header-anchor">#</a> 8、解析URL参数</h2> <div class="language- extra-class"><pre class="language-text"><code>export const getSearchParams = () =&gt; {
  const searchPar = new URLSearchParams(window.location.search)
  const paramsObj = {}
  for (const [key, value] of searchPar.entries()) {
    paramsObj[key] = value
  }
  return paramsObj
}

// 假设目前位于 https://****com/index?id=154513&amp;age=18;
getSearchParams(); // {id: &quot;154513&quot;, age: &quot;18&quot;}
</code></pre></div><h2 id="_9、判断手机是andoird还是ios"><a href="#_9、判断手机是andoird还是ios" class="header-anchor">#</a> 9、判断手机是Andoird还是IOS</h2> <div class="language- extra-class"><pre class="language-text"><code>/** 
 * 1: ios
 * 2: android
 * 3: 其它
 */
export const getOSType=() =&gt; {
  let u = navigator.userAgent, app = navigator.appVersion;
  let isAndroid = u.indexOf('Android') &gt; -1 || u.indexOf('Linux') &gt; -1;
  let isIOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
  if (isIOS) {
    return 1;
  }
  if (isAndroid) {
    return 2;
  }
  return 3;
}
</code></pre></div><h2 id="_10、数组对象根据字段去重"><a href="#_10、数组对象根据字段去重" class="header-anchor">#</a> 10、数组对象根据字段去重</h2> <div class="language- extra-class"><pre class="language-text"><code>// arr 要去重的数组
// key 根据去重的字段名
export const uniqueArrayObject = (arr = [], key = 'id') =&gt; {
  if (arr.length === 0) return
  let list = []
  const map = {}
  arr.forEach((item) =&gt; {
    if (!map[item[key]]) {
      map[item[key]] = item
    }
  })
  list = Object.values(map)

  return list
}
</code></pre></div><h2 id="_11、滚动到页面顶部"><a href="#_11、滚动到页面顶部" class="header-anchor">#</a> 11、滚动到页面顶部</h2> <div class="language- extra-class"><pre class="language-text"><code>export const scrollToTop = () =&gt; {
  const height = document.documentElement.scrollTop || document.body.scrollTop;
  if (height &gt; 0) {
    window.requestAnimationFrame(scrollToTop);
    window.scrollTo(0, height - height / 8);
  }
}
</code></pre></div><h2 id="_12、滚动到元素位置"><a href="#_12、滚动到元素位置" class="header-anchor">#</a> 12、滚动到元素位置</h2> <div class="language- extra-class"><pre class="language-text"><code>export const smoothScroll = element =&gt;{
    document.querySelector(element).scrollIntoView({
        behavior: 'smooth'
    });
};
</code></pre></div><h2 id="_13、金额格式化"><a href="#_13、金额格式化" class="header-anchor">#</a> 13、金额格式化</h2> <div class="language- extra-class"><pre class="language-text"><code>// {number} number：要格式化的数字
// {number} decimals：保留几位小数
// {string} dec_point：小数点符号
// {string} thousands_sep：千分位符号
export const moneyFormat = (number, decimals, dec_point, thousands_sep) =&gt; {
  number = (number + '').replace(/[^0-9+-Ee.]/g, '')
  const n = !isFinite(+number) ? 0 : +number
  const prec = !isFinite(+decimals) ? 2 : Math.abs(decimals)
  const sep = typeof thousands_sep === 'undefined' ? ',' : thousands_sep
  const dec = typeof dec_point === 'undefined' ? '.' : dec_point
  let s = ''
  const toFixedFix = function(n, prec) {
    const k = Math.pow(10, prec)
    return '' + Math.ceil(n * k) / k
  }
  s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.')
  const re = /(-?\d+)(\d{3})/
  while (re.test(s[0])) {
    s[0] = s[0].replace(re, '$1' + sep + '$2')
  }

  if ((s[1] || '').length &lt; prec) {
    s[1] = s[1] || ''
    s[1] += new Array(prec - s[1].length + 1).join('0')
  }
  return s.join(dec)
}
</code></pre></div><h2 id="_14、存储操作"><a href="#_14、存储操作" class="header-anchor">#</a> 14、存储操作</h2> <div class="language- extra-class"><pre class="language-text"><code>class MyCache {
  constructor(isLocal = true) {
    this.storage = isLocal ? localStorage : sessionStorage
  }

  setItem(key, value) {
    if (typeof (value) === 'object') value = JSON.stringify(value)
    this.storage.setItem(key, value)
  }

  getItem(key) {
    try {
      return JSON.parse(this.storage.getItem(key))
    } catch (err) {
      return this.storage.getItem(key)
    }
  }

  removeItem(key) {
    this.storage.removeItem(key)
  }

  clear() {
    this.storage.clear()
  }

  key(index) {
    return this.storage.key(index)
  }

  length() {
    return this.storage.length
  }
}

const localCache = new MyCache()
const sessionCache = new MyCache(false)

export { localCache, sessionCache }
</code></pre></div><h2 id="_15、下载文件"><a href="#_15、下载文件" class="header-anchor">#</a> 15、下载文件</h2> <div class="language- extra-class"><pre class="language-text"><code>//api 接口
//params 请求参数
//fileName 文件名
const downloadFile = (api, params, fileName, type = 'get') =&gt; {
  axios({
    method: type,
    url: api,
    responseType: 'blob', 
    params: params
  }).then((res) =&gt; {
    let str = res.headers['content-disposition']
    if (!res || !str) {
      return
    }
    let suffix = ''
    // 截取文件名和文件类型
    if (str.lastIndexOf('.')) {
      fileName ? '' : fileName = decodeURI(str.substring(str.indexOf('=') + 1, str.lastIndexOf('.')))
      suffix = str.substring(str.lastIndexOf('.'), str.length)
    }
    //  如果支持微软的文件下载方式(ie10+浏览器)
    if (window.navigator.msSaveBlob) {
      try {
        const blobObject = new Blob([res.data]);
        window.navigator.msSaveBlob(blobObject, fileName + suffix);
      } catch (e) {
        console.log(e);
      }
    } else {
      //  其他浏览器
      let url = window.URL.createObjectURL(res.data)
      let link = document.createElement('a')
      link.style.display = 'none'
      link.href = url
      link.setAttribute('download', fileName + suffix)
      document.body.appendChild(link)
      link.click()
      document.body.removeChild(link)
      window.URL.revokeObjectURL(link.href);
    }
  }).catch((err) =&gt; {
    console.log(err.message);
  })
}


</code></pre></div><h2 id="_16、深拷贝"><a href="#_16、深拷贝" class="header-anchor">#</a> 16、深拷贝</h2> <p>此方法存在一定局限性：一些特殊情况没有处理: 例如Buffer对象、Promise、Set、Map。</p> <div class="language- extra-class"><pre class="language-text"><code>export const clone = parent =&gt; {
  // 判断类型
  const isType = (obj, type) =&gt; {
    if (typeof obj !== &quot;object&quot;) return false;
    const typeString = Object.prototype.toString.call(obj);
    let flag;
    switch (type) {
      case &quot;Array&quot;:
        flag = typeString === &quot;[object Array]&quot;;
        break;
      case &quot;Date&quot;:
        flag = typeString === &quot;[object Date]&quot;;
        break;
      case &quot;RegExp&quot;:
        flag = typeString === &quot;[object RegExp]&quot;;
        break;
      default:
        flag = false;
    }
    return flag;
  };

  // 处理正则
  const getRegExp = re =&gt; {
    var flags = &quot;&quot;;
    if (re.global) flags += &quot;g&quot;;
    if (re.ignoreCase) flags += &quot;i&quot;;
    if (re.multiline) flags += &quot;m&quot;;
    return flags;
  };
  // 维护两个储存循环引用的数组
  const parents = [];
  const children = [];

  const _clone = parent =&gt; {
    if (parent === null) return null;
    if (typeof parent !== &quot;object&quot;) return parent;

    let child, proto;

    if (isType(parent, &quot;Array&quot;)) {
      // 对数组做特殊处理
      child = [];
    } else if (isType(parent, &quot;RegExp&quot;)) {
      // 对正则对象做特殊处理
      child = new RegExp(parent.source, getRegExp(parent));
      if (parent.lastIndex) child.lastIndex = parent.lastIndex;
    } else if (isType(parent, &quot;Date&quot;)) {
      // 对Date对象做特殊处理
      child = new Date(parent.getTime());
    } else {
      // 处理对象原型
      proto = Object.getPrototypeOf(parent);
      // 利用Object.create切断原型链
      child = Object.create(proto);
    }

    // 处理循环引用
    const index = parents.indexOf(parent);

    if (index != -1) {
      // 如果父数组存在本对象,说明之前已经被引用过,直接返回此对象
      return children[index];
    }
    parents.push(parent);
    children.push(child);

    for (let i in parent) {
      // 递归
      child[i] = _clone(parent[i]);
    }

    return child;
  };
  return _clone(parent);
};
</code></pre></div><h2 id="_17、模糊搜索"><a href="#_17、模糊搜索" class="header-anchor">#</a> 17、模糊搜索</h2> <div class="language- extra-class"><pre class="language-text"><code>// list 原数组
// keyWord 查询的关键词
// attribute 数组需要检索属性
export const fuzzyQuery = (list, keyWord, attribute = 'name') =&gt; {
  const reg = new RegExp(keyWord)
  const arr = []
  for (let i = 0; i &lt; list.length; i++) {
    if (reg.test(list[i][attribute])) {
      arr.push(list[i])
    }
  }
  return arr
}

//示例
const list = [
  { id: 1, name: '树哥' },
  { id: 2, name: '黄老爷' },
  { id: 3, name: '张麻子' },
  { id: 4, name: '汤师爷' },
  { id: 5, name: '胡万' },
  { id: 6, name: '花姐' },
  { id: 7, name: '小梅' }
]
fuzzyQuery(list, '树', 'name') // [{id: 1, name: '树哥'}]
</code></pre></div><h2 id="_18、遍历树节点"><a href="#_18、遍历树节点" class="header-anchor">#</a> 18、遍历树节点</h2> <div class="language- extra-class"><pre class="language-text"><code>export const foreachTree = (data, callback, childrenName = 'children') =&gt; {
  for (let i = 0; i &lt; data.length; i++) {
    callback(data[i])
    if (data[i][childrenName] &amp;&amp; data[i][childrenName].length &gt; 0) {
      foreachTree(data[i][childrenName], callback, childrenName)
    }
  }
}
// 示例
const treeData = [{
  id: 1,
  label: '一级 1',
  children: [{
    id: 4,
    label: '二级 1-1',
    children: [{
      id: 9,
      label: '三级 1-1-1'
    }, {
      id: 10,
      label: '三级 1-1-2'
    }]
  }]
 }, {
  id: 2,
  label: '一级 2',
  children: [{
    id: 5,
    label: '二级 2-1'
  }, {
    id: 6,
    label: '二级 2-2'
  }]
  }, {
    id: 3,
    label: '一级 3',
    children: [{
      id: 7,
      label: '二级 3-1'
    }, {
      id: 8,
      label: '二级 3-2'
    }]
}],

let result
foreachTree(data, (item) =&gt; {
  if (item.id === 9) {
    result = item
  }
})
console.log('result', result)  // {id: 9,label: &quot;三级 1-1-1&quot;} 
</code></pre></div><h2 id="_19、停止冒泡事件"><a href="#_19、停止冒泡事件" class="header-anchor">#</a> 19、停止冒泡事件</h2> <div class="language- extra-class"><pre class="language-text"><code>const stopPropagation = (event) =&gt; {
  event = event || window.event;
  if (event.stopPropagation) {
    event.stopPropagation();
  } else {
    event.cancelBubble = true;
  }
};
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuepress-blog/git操作指令.html" class="prev">
        git命令总结
      </a></span> <span class="next"><a href="/vuepress-blog/js执行机制.html">
        js执行机制
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><section class="side-anchor"><ul style="display:none;"></ul></section></div></div>
    <script src="/vuepress-blog/assets/js/app.ae308451.js" defer></script><script src="/vuepress-blog/assets/js/2.9d54d2e6.js" defer></script><script src="/vuepress-blog/assets/js/8.a3e3bbda.js" defer></script>
  </body>
</html>
